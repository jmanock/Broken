<div class='container'>
  <div ng-include="'components/navbar/navbar.html'"></div>

   <div ng-controller='StandingsCtrl as standings'>
  <p>This is the standings page</p>
  <p>* This should show the usersTeam (weeksTeam)</p>
  <p>* This should show the leader board (pga leaderboard)</p>
  <p>* This should show the overall leaders (overallLeaders)</p>

  <ul>
    <h3>Players</h3>
    <li ng-repeat='(id, player) in standings.players'>{{player.Name}}
     <button ng-click='standings.addPlayer(standings.players[$index])' class='add'>Add</button></li> 
  </ul>
</div>
</div>

 <h3>Current Id</h3>
 <div></div>
 <button id="inc">increment</button>
 <button id="clear">reset data</button>

 <h4>Try to make record without incrementing ID</h4>
 <input type="text" id="custom" /><button id="customButton">add</button>

 <pre id="data"></pre>


 <script>
 var fb = new Firebase("https://reditclone.firebaseio.com/Team");

// monitors changes and updates UI
//fb.child('counter').on('value', updateDiv);
//fb.on('value', updatePre);

// creates a new, incremental record
$('#inc').on('click', incId);

// resets the data
$('#clear').on('click', function() {
 fb.remove();
});

// attempts to create any id you put in
$('#customButton').on('click', function() {
 addRecord($('#custom').val());
});

var errId = 0;
// creates a new, incremental record
function incId() {
  // increment the counter
  fb.child('counter').transaction(function(currentValue) {
      return (currentValue||0) + 1
  }, function(err, committed, ss) {
      if( err ) {
         setError(err);
      }
      else if( committed ) {
         // if counter update succeeds, then create record
         // probably want a recourse for failures too
         addRecord(ss.val());
      }
  });
}

// creates new incremental record
function addRecord(id) {
  setTimeout(function() {
     fb.child('Players').child('player'+id).set('player #'+id, function(err) {
        err && setError(err);
     });
  });
}

// for demo purposes
function updateDiv(ss) {
 $('div').text(ss.val()||0);
 $('#custom').val('rec'+(parseInt(ss.val(), 10)+1));
}

// for demo purposes
function updatePre(ss) {
 $('#data').text(JSON.stringify(ss.val(), null, 2));
}

// for demo purposes
function setError(msg) {
  var id = ++errId;
  $('body').append('<p id="err'+id+'">'+msg+'</p>');
  setTimeout(function() { $('#err'+id).fadeOut(); }, 2500);
}

 </script>
